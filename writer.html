<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Помощник для написания книги</title>
  <script src="https://cdn.jsdelivr.net/npm/react@18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@babel/standalone@7.22.9/babel.min.js"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Roboto:wght@300;400;700&display=swap');

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Roboto', sans-serif;
    }

    body {
      background: linear-gradient(-45deg, #0a0a23, #1a1a3e, #2a2a5e, #0a0a23);
      background-size: 400% 400%;
      animation: gradientShift 15s ease infinite;
      color: #e0e0ff;
    }

    @keyframes gradientShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    .app-container {
      display: flex;
      min-height: 100vh;
    }

    .sidebar {
      width: 300px;
      background: rgba(10, 10, 35, 0.85);
      backdrop-filter: blur(12px);
      color: #00ffcc;
      padding: 30px;
      position: fixed;
      height: 100%;
      overflow-y: auto;
      border-right: 2px solid rgba(0, 255, 204, 0.3);
      box-shadow: 0 0 30px rgba(0, 255, 204, 0.4);
      transition: transform 0.3s ease;
    }

    .sidebar:hover {
      transform: translateX(5px);
    }

    .sidebar h2 {
      font-family: 'Orbitron', sans-serif;
      font-size: 2em;
      margin-bottom: 30px;
      text-transform: uppercase;
      text-shadow: 0 0 15px #00ffcc, 0 0 30px #00b7eb;
      letter-spacing: 2px;
    }

    .sidebar ul {
      list-style: none;
    }

    .sidebar li {
      margin: 15px 0;
    }

    .sidebar a {
      color: #00ffcc;
      text-decoration: none;
      font-size: 1.2em;
      display: block;
      padding: 12px 15px;
      border-radius: 10px;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .sidebar a::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(0, 255, 204, 0.3), transparent);
      transition: 0.5s;
    }

    .sidebar a:hover::before,
    .sidebar a.active::before {
      left: 100%;
    }

    .sidebar a:hover,
    .sidebar a.active {
      background: rgba(0, 255, 204, 0.2);
      box-shadow: 0 0 20px rgba(0, 255, 204, 0.5);
      transform: scale(1.05);
    }

    .main-content {
      margin-left: 300px;
      padding: 40px;
      flex-grow: 1;
      background: rgba(20, 20, 50, 0.9);
    }

    .section {
      max-width: 1000px;
      margin: 0 auto;
      background: rgba(30, 30, 60, 0.7);
      backdrop-filter: blur(10px);
      padding: 30px;
      border-radius: 15px;
      box-shadow: 0 0 30px rgba(0, 255, 204, 0.4);
      border: 2px solid rgba(0, 255, 204, 0.3);
      transition: transform 0.3s ease;
    }

    .section:hover {
      transform: translateY(-5px);
    }

    h1 {
      font-family: 'Orbitron', sans-serif;
      font-size: 2.5em;
      margin-bottom: 25px;
      color: #00ffcc;
      text-shadow: 0 0 15px #00ffcc, 0 0 30px #00b7eb;
      letter-spacing: 1px;
    }

    h2 {
      font-family: 'Orbitron', sans-serif;
      font-size: 1.8em;
      margin-bottom: 20px;
      color: #e0e0ff;
      text-shadow: 0 0 10px rgba(0, 255, 204, 0.5);
    }

    .form-group {
      margin-bottom: 25px;
    }

    .form-group label {
      display: block;
      margin-bottom: 10px;
      font-weight: 400;
      color: #00ffcc;
      text-shadow: 0 0 5px rgba(0, 255, 204, 0.5);
    }

    .form-group input,
    .form-group textarea,
    .form-group select {
      width: 100%;
      padding: 12px;
      border: 2px solid rgba(0, 255, 204, 0.3);
      border-radius: 8px;
      background: rgba(10, 10, 35, 0.7);
      color: #e0e0ff;
      font-size: 1em;
      transition: all 0.3s ease;
    }

    .form-group input:focus,
    .form-group textarea:focus,
    .form-group select:focus {
      outline: none;
      border-color: #00ffcc;
      box-shadow: 0 0 15px rgba(0, 255, 204, 0.7);
      background: rgba(10, 10, 35, 0.9);
    }

    .form-group textarea {
      min-height: 140px;
      resize: vertical;
    }

    .button {
      background: linear-gradient(45deg, #00ffcc, #00b7eb);
      color: #0a0a23;
      padding: 12px 25px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-family: 'Orbitron', sans-serif;
      font-size: 1em;
      font-weight: 700;
      margin-right: 15px;
      position: relative;
      overflow: hidden;
      transition: all 0.3s ease;
    }

    .button::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      transition: 0.5s;
    }

    .button:hover::before {
      left: 100%;
    }

    .button:hover {
      transform: scale(1.1);
      box-shadow: 0 0 20px rgba(0, 255, 204, 0.8);
    }

    .button.delete {
      background: linear-gradient(45deg, #ff4d4d, #cc0000);
    }

    .button.delete:hover {
      box-shadow: 0 0 20px rgba(255, 77, 77, 0.8);
    }

    .list-item {
      padding: 20px;
      border-bottom: 2px solid rgba(0, 255, 204, 0.2);
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: rgba(30, 30, 60, 0.5);
      margin-bottom: 15px;
      border-radius: 10px;
      transition: all 0.3s ease;
    }

    .list-item:hover {
      background: rgba(30, 30, 60, 0.8);
      box-shadow: 0 0 15px rgba(0, 255, 204, 0.5);
      transform: translateY(-3px);
    }

    .timeline {
      position: relative;
      margin: 40px 0;
      padding-left: 50px;
    }

    .timeline::before {
      content: '';
      position: absolute;
      left: 20px;
      top: 0;
      bottom: 0;
      width: 8px;
      background: linear-gradient(to bottom, #00ffcc, #00b7eb);
      box-shadow: 0 0 15px rgba(0, 255, 204, 0.7);
      border-radius: 4px;
    }

    .timeline-item {
      position: relative;
      margin-bottom: 30px;
      background: rgba(10, 10, 35, 0.8);
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 20px rgba(0, 255, 204, 0.4);
      transition: transform 0.3s ease;
    }

    .timeline-item:hover {
      transform: translateX(10px);
    }

    .timeline-item::before {
      content: '';
      position: absolute;
      left: -38px;
      width: 20px;
      height: 20px;
      background: #00ffcc;
      border-radius: 50%;
      top: 25px;
      box-shadow: 0 0 20px rgba(0, 255, 204, 0.8);
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.3); opacity: 0.7; }
      100% { transform: scale(1); opacity: 1; }
    }

    .timeline-item h3 {
      font-family: 'Orbitron', sans-serif;
      font-size: 1.4em;
      margin-bottom: 10px;
      color: #00ffcc;
      text-shadow: 0 0 10px rgba(0, 255, 204, 0.5);
    }

    .notes-content {
      white-space: pre-wrap;
      color: #e0e0ff;
      line-height: 1.6;
    }

    .notes-content b {
      font-weight: bold;
      color: #00ffcc;
      text-shadow: 0 0 5px rgba(0, 255, 204, 0.5);
    }

    .notes-content i {
      font-style: italic;
      color: #80e5ff;
    }

    .notes-content ul {
      list-style: disc;
      margin-left: 30px;
    }

    .export-import {
      margin: 40px 0;
    }

    .export-import input {
      background: rgba(10, 10, 35, 0.7);
      color: #e0e0ff;
      padding: 12px;
      border: 2px solid rgba(0, 255, 204, 0.3);
      border-radius: 8px;
      transition: all 0.3s ease;
    }

    .export-import input:hover {
      border-color: #00ffcc;
      box-shadow: 0 0 15px rgba(0, 255, 204, 0.5);
    }

    @media (max-width: 768px) {
      .sidebar {
        width: 100%;
        height: auto;
        position: static;
        padding: 20px;
        border-right: none;
        border-bottom: 2px solid rgba(0, 255, 204, 0.3);
      }

      .main-content {
        margin-left: 0;
        padding: 20px;
      }

      .section {
        padding: 20px;
        border-radius: 10px;
      }

      .button {
        padding: 10px 20px;
        font-size: 0.9em;
      }

      .timeline {
        padding-left: 40px;
      }

      .timeline-item::before {
        left: -28px;
        width: 16px;
        height: 16px;
      }
    }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useEffect } = React;

    // Главный компонент приложения
    function App() {
      const [section, setSection] = useState('ideas');
      const [ideas, setIdeas] = useState([]);
      const [characters, setCharacters] = useState([]);
      const [plot, setPlot] = useState([]);
      const [notes, setNotes] = useState([]);
      const [locations, setLocations] = useState([]);
      const [search, setSearch] = useState('');

      // Загрузка данных из localStorage при инициализации
      useEffect(() => {
        const savedIdeas = localStorage.getItem('ideas');
        if (savedIdeas) setIdeas(JSON.parse(savedIdeas));
        const savedCharacters = localStorage.getItem('characters');
        if (savedCharacters) setCharacters(JSON.parse(savedCharacters));
        const savedPlot = localStorage.getItem('plot');
        if (savedPlot) setPlot(JSON.parse(savedPlot));
        const savedNotes = localStorage.getItem('notes');
        if (savedNotes) setNotes(JSON.parse(savedNotes));
        const savedLocations = localStorage.getItem('locations');
        if (savedLocations) setLocations(JSON.parse(savedLocations));
      }, []);

      // Сохранение данных в localStorage при изменении
      useEffect(() => {
        localStorage.setItem('ideas', JSON.stringify(ideas));
        localStorage.setItem('characters', JSON.stringify(characters));
        localStorage.setItem('plot', JSON.stringify(plot));
        localStorage.setItem('notes', JSON.stringify(notes));
        localStorage.setItem('locations', JSON.stringify(locations));
      }, [ideas, characters, plot, notes, locations]);

      // Экспорт данных в JSON
      const exportData = () => {
        const data = { ideas, characters, plot, notes, locations };
        const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'book_data.json';
        a.click();
        URL.revokeObjectURL(url);
      };

      // Импорт данных из JSON
      const importData = (event) => {
        const file = event.target.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = (e) => {
            try {
              const data = JSON.parse(e.target.result);
              if (data.ideas) setIdeas(data.ideas);
              if (data.characters) setCharacters(data.characters);
              if (data.plot) setPlot(data.plot);
              if (data.notes) setNotes(data.notes);
              if (data.locations) setLocations(data.locations);
              alert('Данные успешно импортированы!');
            } catch (error) {
              alert('Ошибка при импорте данных');
            }
          };
          reader.readAsText(file);
        }
      };

      return (
        <div className="app-container">
          <div className="sidebar">
            <h2>Помощник писателя</h2>
            <ul>
              <li><a href="#" className={section === 'ideas' ? 'active' : ''} onClick={() => setSection('ideas')}>Идеи</a></li>
              <li><a href="#" className={section === 'characters' ? 'active' : ''} onClick={() => setSection('characters')}>Персонажи</a></li>
              <li><a href="#" className={section === 'plot' ? 'active' : ''} onClick={() => setSection('plot')}>Сюжет</a></li>
              <li><a href="#" className={section === 'locations' ? 'active' : ''} onClick={() => setSection('locations')}>Локации</a></li>
              <li><a href="#" className={section === 'notes' ? 'active' : ''} onClick={() => setSection('notes')}>Заметки</a></li>
            </ul>
            <div className="export-import">
              <button className="button" onClick={exportData}>Экспорт данных</button>
              <input type="file" accept=".json" onChange={importData} style={{ marginTop: '15px' }} />
            </div>
          </div>
          <div className="main-content">
            {section === 'ideas' && <IdeasSection ideas={ideas} setIdeas={setIdeas} search={search} setSearch={setSearch} />}
            {section === 'characters' && <CharactersSection characters={characters} setCharacters={setCharacters} />}
            {section === 'plot' && <PlotSection plot={plot} setPlot={setPlot} characters={characters} />}
            {section === 'locations' && <LocationsSection locations={locations} setLocations={setLocations} />}
            {section === 'notes' && <NotesSection notes={notes} setNotes={setNotes} />}
          </div>
        </div>
      );
    }

    // Компонент раздела "Идеи"
    function IdeasSection({ ideas, setIdeas, search, setSearch }) {
      const [newIdea, setNewIdea] = useState({ title: '', description: '', category: 'Концепция мира', tags: '' });
      const [editIdea, setEditIdea] = useState(null);
      const [filterCategory, setFilterCategory] = useState('Все');

      const addIdea = () => {
        if (newIdea.title && newIdea.description) {
          setIdeas([...ideas, { ...newIdea, id: Date.now() }]);
          setNewIdea({ title: '', description: '', category: 'Концепция мира', tags: '' });
        }
      };

      const updateIdea = () => {
        setIdeas(ideas.map(idea => idea.id === editIdea.id ? editIdea : idea));
        setEditIdea(null);
      };

      const deleteIdea = (id) => {
        setIdeas(ideas.filter(idea => idea.id !== id));
      };

      const filteredIdeas = ideas
        .filter(idea => filterCategory === 'Все' || idea.category === filterCategory)
        .filter(idea => 
          idea.title.toLowerCase().includes(search.toLowerCase()) || 
          idea.description.toLowerCase().includes(search.toLowerCase()) ||
          idea.tags.toLowerCase().includes(search.toLowerCase())
        );

      return (
        <div className="section">
          <h1>Идеи</h1>
          <div className="form-group">
            <label>Поиск</label>
            <input type="text" value={search} onChange={(e) => setSearch(e.target.value)} placeholder="Поиск по идеям или тегам..." />
          </div>
          <div className="form-group">
            <label>Фильтр по категории</label>
            <select value={filterCategory} onChange={(e) => setFilterCategory(e.target.value)}>
              <option>Все</option>
              <option>Концепция мира</option>
              <option>Тема</option>
              <option>Сцена</option>
              <option>Конфликт</option>
              <option>Символика</option>
            </select>
          </div>
          <h2>{editIdea ? 'Редактировать идею' : 'Добавить идею'}</h2>
          <div className="form-group">
            <label>Название</label>
            <input
              type="text"
              value={editIdea ? editIdea.title : newIdea.title}
              onChange={(e) => editIdea ? setEditIdea({ ...editIdea, title: e.target.value }) : setNewIdea({ ...newIdea, title: e.target.value })}
            />
          </div>
          <div className="form-group">
            <label>Описание</label>
            <textarea
              value={editIdea ? editIdea.description : newIdea.description}
              onChange={(e) => editIdea ? setEditIdea({ ...editIdea, description: e.target.value }) : setNewIdea({ ...newIdea, description: e.target.value })}
            ></textarea>
          </div>
          <div className="form-group">
            <label>Категория</label>
            <select
              value={editIdea ? editIdea.category : newIdea.category}
              onChange={(e) => editIdea ? setEditIdea({ ...editIdea, category: e.target.value }) : setNewIdea({ ...newIdea, category: e.target.value })}
            >
              <option>Концепция мира</option>
              <option>Тема</option>
              <option>Сцена</option>
              <option>Конфликт</option>
              <option>Символика</option>
            </select>
          </div>
          <div className="form-group">
            <label>Теги (через запятую)</label>
            <input
              type="text"
              value={editIdea ? editIdea.tags : newIdea.tags}
              onChange={(e) => editIdea ? setEditIdea({ ...editIdea, tags: e.target.value }) : setNewIdea({ ...newIdea, tags: e.target.value })}
              placeholder="например: приключение, магия, дружба"
            />
          </div>
          <button className="button" onClick={editIdea ? updateIdea : addIdea}>
            {editIdea ? 'Сохранить' : 'Добавить'}
          </button>
          {editIdea && <button className="button" onClick={() => setEditIdea(null)}>Отмена</button>}
          <h2>Список идей</h2>
          {filteredIdeas.map(idea => (
            <div key={idea.id} className="list-item">
              <div>
                <strong>{idea.title}</strong> ({idea.category})<br />
                {idea.description}<br />
                <small>Теги: {idea.tags}</small>
              </div>
              <div>
                <button className="button" onClick={() => setEditIdea(idea)}>Редактировать</button>
                <button className="button delete" onClick={() => deleteIdea(idea.id)}>Удалить</button>
              </div>
            </div>
          ))}
        </div>
      );
    }

    // Компонент раздела "Персонажи"
    function CharactersSection({ characters, setCharacters }) {
      const [newCharacter, setNewCharacter] = useState({ 
        name: '', 
        age: '', 
        description: '', 
        role: '', 
        traits: '', 
        relationships: '', 
        motivation: '', 
        backstory: '' 
      });
      const [editCharacter, setEditCharacter] = useState(null);
      const [selectedCharacter, setSelectedCharacter] = useState(null);

      const addCharacter = () => {
        if (newCharacter.name) {
          setCharacters([...characters, { ...newCharacter, id: Date.now() }]);
          setNewCharacter({ name: '', age: '', description: '', role: '', traits: '', relationships: '', motivation: '', backstory: '' });
        }
      };

      const updateCharacter = () => {
        setCharacters(characters.map(char => char.id === editCharacter.id ? editCharacter : char));
        setEditCharacter(null);
        setSelectedCharacter(null);
      };

      const deleteCharacter = (id) => {
        setCharacters(characters.filter(char => char.id !== id));
        setSelectedCharacter(null);
      };

      return (
        <div className="section">
          <h1>Персонажи</h1>
          {selectedCharacter ? (
            <div>
              <h2>{selectedCharacter.name}</h2>
              <p><strong>Возраст:</strong> {selectedCharacter.age}</p>
              <p><strong>Описание:</strong> {selectedCharacter.description}</p>
              <p><strong>Роль:</strong> {selectedCharacter.role}</p>
              <p><strong>Черты характера:</strong> {selectedCharacter.traits}</p>
              <p><strong>Связи:</strong> {selectedCharacter.relationships}</p>
              <p><strong>Мотивация:</strong> {selectedCharacter.motivation}</p>
              <p><strong>Предыстория:</strong> {selectedCharacter.backstory}</p>
              <button className="button" onClick={() => setEditCharacter(selectedCharacter)}>Редактировать</button>
              <button className="button" onClick={() => setSelectedCharacter(null)}>Назад</button>
            </div>
          ) : (
            <>
              <h2>{editCharacter ? 'Редактировать персонажа' : 'Добавить персонажа'}</h2>
              <div className="form-group">
                <label>Имя</label>
                <input
                  type="text"
                  value={editCharacter ? editCharacter.name : newCharacter.name}
                  onChange={(e) => editCharacter ? setEditCharacter({ ...editCharacter, name: e.target.value }) : setNewCharacter({ ...newCharacter, name: e.target.value })}
                />
              </div>
              <div className="form-group">
                <label>Возраст</label>
                <input
                  type="text"
                  value={editCharacter ? editCharacter.age : newCharacter.age}
                  onChange={(e) => editCharacter ? setEditCharacter({ ...editCharacter, age: e.target.value }) : setNewCharacter({ ...newCharacter, age: e.target.value })}
                />
              </div>
              <div className="form-group">
                <label>Описание</label>
                <textarea
                  value={editCharacter ? editCharacter.description : newCharacter.description}
                  onChange={(e) => editCharacter ? setEditCharacter({ ...editCharacter, description: e.target.value }) : setNewCharacter({ ...newCharacter, description: e.target.value })}
                ></textarea>
              </div>
              <div className="form-group">
                <label>Роль в истории</label>
                <input
                  type="text"
                  value={editCharacter ? editCharacter.role : newCharacter.role}
                  onChange={(e) => editCharacter ? setEditCharacter({ ...editCharacter, role: e.target.value }) : setNewCharacter({ ...newCharacter, role: e.target.value })}
                />
              </div>
              <div className="form-group">
                <label>Черты характера</label>
                <input
                  type="text"
                  value={editCharacter ? editCharacter.traits : newCharacter.traits}
                  onChange={(e) => editCharacter ? setEditCharacter({ ...editCharacter, traits: e.target.value }) : setNewCharacter({ ...newCharacter, traits: e.target.value })}
                />
              </div>
              <div className="form-group">
                <label>Связи с другими персонажами</label>
                <input
                  type="text"
                  value={editCharacter ? editCharacter.relationships : newCharacter.relationships}
                  onChange={(e) => editCharacter ? setEditCharacter({ ...editCharacter, relationships: e.target.value }) : setNewCharacter({ ...newCharacter, relationships: e.target.value })}
                />
              </div>
              <div className="form-group">
                <label>Мотивация</label>
                <textarea
                  value={editCharacter ? editCharacter.motivation : newCharacter.motivation}
                  onChange={(e) => editCharacter ? setEditCharacter({ ...editCharacter, motivation: e.target.value }) : setNewCharacter({ ...newCharacter, motivation: e.target.value })}
                ></textarea>
              </div>
              <div className="form-group">
                <label>Предыстория</label>
                <textarea
                  value={editCharacter ? editCharacter.backstory : newCharacter.backstory}
                  onChange={(e) => editCharacter ? setEditCharacter({ ...editCharacter, backstory: e.target.value }) : setNewCharacter({ ...newCharacter, backstory: e.target.value })}
                ></textarea>
              </div>
              <button className="button" onClick={editCharacter ? updateCharacter : addCharacter}>
                {editCharacter ? 'Сохранить' : 'Добавить'}
              </button>
              {editCharacter && <button className="button" onClick={() => setEditCharacter(null)}>Отмена</button>}
              <h2>Список персонажей</h2>
              {characters.map(char => (
                <div key={char.id} className="list-item">
                  <div onClick={() => setSelectedCharacter(char)}>
                    <strong>{char.name}</strong> ({char.role})
                  </div>
                  <div>
                    <button className="button" onClick={() => setEditCharacter(char)}>Редактировать</button>
                    <button className="button delete" onClick={() => deleteCharacter(char.id)}>Удалить</button>
                  </div>
                </div>
              ))}
            </>
          )}
        </div>
      );
    }

    // Компонент раздела "Сюжет"
    function PlotSection({ plot, setPlot, characters }) {
      const [newPlot, setNewPlot] = useState({ 
        title: '', 
        description: '', 
        events: '', 
        characters: '', 
        conflict: '', 
        resolution: '' 
      });
      const [editPlot, setEditPlot] = useState(null);

      const addPlot = () => {
        if (newPlot.title) {
          setPlot([...plot, { ...newPlot, id: Date.now() }]);
          setNewPlot({ title: '', description: '', events: '', characters: '', conflict: '', resolution: '' });
        }
      };

      const updatePlot = () => {
        setPlot(plot.map(item => item.id === editPlot.id ? editPlot : item));
        setEditPlot(null);
      };

      const deletePlot = (id) => {
        setPlot(plot.filter(item => item.id !== id));
      };

      return (
        <div className="section">
          <h1>Сюжет</h1>
          <h2>{editPlot ? 'Редактировать сюжет' : 'Добавить сюжет'}</h2>
          <div className="form-group">
            <label>Название</label>
            <input
              type="text"
              value={editPlot ? editPlot.title : newPlot.title}
              onChange={(e) => editPlot ? setEditPlot({ ...editPlot, title: e.target.value }) : setNewPlot({ ...newPlot, title: e.target.value })}
            />
          </div>
          <div className="form-group">
            <label>Описание</label>
            <textarea
              value={editPlot ? editPlot.description : newPlot.description}
              onChange={(e) => editPlot ? setEditPlot({ ...editPlot, description: e.target.value }) : setNewPlot({ ...newPlot, description: e.target.value })}
            ></textarea>
          </div>
          <div className="form-group">
            <label>Ключевые события</label>
            <textarea
              value={editPlot ? editPlot.events : newPlot.events}
              onChange={(e) => editPlot ? setEditPlot({ ...editPlot, events: e.target.value }) : setNewPlot({ ...newPlot, events: e.target.value })}
            ></textarea>
          </div>
          <div className="form-group">
            <label>Связанные персонажи</label>
            <input
              type="text"
              value={editPlot ? editPlot.characters : newPlot.characters}
              onChange={(e) => editPlot ? setEditPlot({ ...editPlot, characters: e.target.value }) : setNewPlot({ ...newPlot, characters: e.target.value })}
            />
          </div>
          <div className="form-group">
            <label>Конфликт</label>
            <textarea
              value={editPlot ? editPlot.conflict : newPlot.conflict}
              onChange={(e) => editPlot ? setEditPlot({ ...editPlot, conflict: e.target.value }) : setNewPlot({ ...newPlot, conflict: e.target.value })}
            ></textarea>
          </div>
          <div className="form-group">
            <label>Разрешение</label>
            <textarea
              value={editPlot ? editPlot.resolution : newPlot.resolution}
              onChange={(e) => editPlot ? setEditPlot({ ...editPlot, resolution: e.target.value }) : setNewPlot({ ...newPlot, resolution: e.target.value })}
            ></textarea>
          </div>
          <button className="button" onClick={editPlot ? updatePlot : addPlot}>
            {editPlot ? 'Сохранить' : 'Добавить'}
          </button>
          {editPlot && <button className="button" onClick={() => setEditPlot(null)}>Отмена</button>}
          <h2>Временная шкала</h2>
          <div className="timeline">
            {plot.map(item => (
              <div key={item.id} className="timeline-item">
                <h3>{item.title}</h3>
                <p>{item.description}</p>
                <p><strong>События:</strong> {item.events}</p>
                <p><strong>Персонажи:</strong> {item.characters}</p>
                <p><strong>Конфликт:</strong> {item.conflict}</p>
                <p><strong>Разрешение:</strong> {item.resolution}</p>
                <button className="button" onClick={() => setEditPlot(item)}>Редактировать</button>
                <button className="button delete" onClick={() => deletePlot(item.id)}>Удалить</button>
              </div>
            ))}
          </div>
        </div>
      );
    }

    // Компонент раздела "Локации"
    function LocationsSection({ locations, setLocations }) {
      const [newLocation, setNewLocation] = useState({ 
        name: '', 
        description: '', 
        atmosphere: '', 
        keyObjects: '', 
        plotConnections: '' 
      });
      const [editLocation, setEditLocation] = useState(null);
      const [selectedLocation, setSelectedLocation] = useState(null);

      const addLocation = () => {
        if (newLocation.name) {
          setLocations([...locations, { ...newLocation, id: Date.now() }]);
          setNewLocation({ name: '', description: '', atmosphere: '', keyObjects: '', plotConnections: '' });
        }
      };

      const updateLocation = () => {
        setLocations(locations.map(loc => loc.id === editLocation.id ? editLocation : loc));
        setEditLocation(null);
        setSelectedLocation(null);
      };

      const deleteLocation = (id) => {
        setLocations(locations.filter(loc => loc.id !== id));
        setSelectedLocation(null);
      };

      return (
        <div className="section">
          <h1>Локации</h1>
          {selectedLocation ? (
            <div>
              <h2>{selectedLocation.name}</h2>
              <p><strong>Описание:</strong> {selectedLocation.description}</p>
              <p><strong>Атмосфера:</strong> {selectedLocation.atmosphere}</p>
              <p><strong>Ключевые объекты:</strong> {selectedLocation.keyObjects}</p>
              <p><strong>Связи с сюжетом:</strong> {selectedLocation.plotConnections}</p>
              <button className="button" onClick={() => setEditLocation(selectedLocation)}>Редактировать</button>
              <button className="button" onClick={() => setSelectedLocation(null)}>Назад</button>
            </div>
          ) : (
            <>
              <h2>{editLocation ? 'Редактировать локацию' : 'Добавить локацию'}</h2>
              <div className="form-group">
                <label>Название</label>
                <input
                  type="text"
                  value={editLocation ? editLocation.name : newLocation.name}
                  onChange={(e) => editLocation ? setEditLocation({ ...editLocation, name: e.target.value }) : setNewLocation({ ...newLocation, name: e.target.value })}
                />
              </div>
              <div className="form-group">
                <label>Описание</label>
                <textarea
                  value={editLocation ? editLocation.description : newLocation.description}
                  onChange={(e) => editLocation ? setEditLocation({ ...editLocation, description: e.target.value }) : setNewLocation({ ...newLocation, description: e.target.value })}
                ></textarea>
              </div>
              <div className="form-group">
                <label>Атмосфера</label>
                <textarea
                  value={editLocation ? editLocation.atmosphere : newLocation.atmosphere}
                  onChange={(e) => editLocation ? setEditLocation({ ...editLocation, atmosphere: e.target.value }) : setNewLocation({ ...newLocation, atmosphere: e.target.value })}
                ></textarea>
              </div>
              <div className="form-group">
                <label>Ключевые объекты</label>
                <textarea
                  value={editLocation ? editLocation.keyObjects : newLocation.keyObjects}
                  onChange={(e) => editLocation ? setEditLocation({ ...editLocation, keyObjects: e.target.value }) : setNewLocation({ ...newLocation, keyObjects: e.target.value })}
                ></textarea>
              </div>
              <div className="form-group">
                <label>Связи с сюжетом/персонажами</label>
                <textarea
                  value={editLocation ? editLocation.plotConnections : newLocation.plotConnections}
                  onChange={(e) => editLocation ? setEditLocation({ ...editLocation, plotConnections: e.target.value }) : setNewLocation({ ...newLocation, plotConnections: e.target.value })}
                ></textarea>
              </div>
              <button className="button" onClick={editLocation ? updateLocation : addLocation}>
                {editLocation ? 'Сохранить' : 'Добавить'}
              </button>
              {editLocation && <button className="button" onClick={() => setEditLocation(null)}>Отмена</button>}
              <h2>Список локаций</h2>
              {locations.map(loc => (
                <div key={loc.id} className="list-item">
                  <div onClick={() => setSelectedLocation(loc)}>
                    <strong>{loc.name}</strong>
                  </div>
                  <div>
                    <button className="button" onClick={() => setEditLocation(loc)}>Редактировать</button>
                    <button className="button delete" onClick={() => deleteLocation(loc.id)}>Удалить</button>
                  </div>
                </div>
              ))}
            </>
          )}
        </div>
      );
    }

    // Компонент раздела "Заметки"
    function NotesSection({ notes, setNotes }) {
      const [newNote, setNewNote] = useState('');
      const [search, setSearch] = useState('');

      const addNote = () => {
        if (newNote) {
          setNotes([...notes, { content: newNote, id: Date.now(), date: new Date().toLocaleString('ru-RU') }]);
          setNewNote('');
        }
      };

      const deleteNote = (id) => {
        setNotes(notes.filter(note => note.id !== id));
      };

      const parseNoteContent = (content) => {
        let formatted = content
          .replace(/\*\*(.*?)\*\*/g, '<b>$1</b>')
          .replace(/\*(.*?)\*/g, '<i>$1</i>')
          .replace(/^- (.*?)$/gm, '<li>$1</li>');
        if (formatted.includes('<li>')) {
          formatted = `<ul>${formatted}</ul>`;
        }
        return formatted;
      };

      const filteredNotes = notes.filter(note => note.content.toLowerCase().includes(search.toLowerCase()));

      return (
        <div className="section">
          <h1>Заметки</h1>
          <div className="form-group">
            <label>Поиск</label>
            <input type="text" value={search} onChange={(e) => setSearch(e.target.value)} placeholder="Поиск по заметкам..." />
          </div>
          <div className="form-group">
            <label>Новая заметка</label>
            <textarea
              value={newNote}
              onChange={(e) => setNewNote(e.target.value)}
              placeholder="Используйте **текст** для жирного, *текст* для курсива, - текст для списка"
            ></textarea>
          </div>
          <button className="button" onClick={addNote}>Добавить заметку</button>
          <h2>Список заметок</h2>
          {filteredNotes.map(note => (
            <div key={note.id} className="list-item">
              <div>
                <div className="notes-content" dangerouslySetInnerHTML={{ __html: parseNoteContent(note.content) }}></div>
                <small>{note.date}</small>
              </div>
              <button className="button delete" onClick={() => deleteNote(note.id)}>Удалить</button>
            </div>
          ))}
        </div>
      );
    }

    // Рендеринг приложения
    ReactDOM.render(<App />, document.getElementById('root'));
  </script>
</body>
</html>
